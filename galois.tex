% Document class
\documentclass[12pt]{article}

% Conditional variables
\newif\ifexamples
\newif\ifproofs

\examplesfalse
\proofsfalse

% Document packages
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{indentfirst}

% Commands
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\renewcommand{\C}{\mathbb{C}}
\newcommand{\Fp}{\mathbb{F}_p}
\newcommand{\Gal}{\mathrm{Gal}}
\newcommand{\id}{\textbf{id}\,}
\newcommand{\proof}{\textit{Доказательство.\;\;}}
\newcommand{\cont}{\mathrm{cont}}

\begin{document}

\section{Определения}

В абстрактной алгебре расширения полей -- это важный объект
изучения.
Общая идея состоит в том, чтобы начать с основного поля и добавить
к нему новое число, доопределив все операции в большем поле.
Например, $\Q(\sqrt2) = \{ a+b\sqrt2 \; | \; a, b \in \Q \}$ -- это
наименьшее расширение $\Q$, которое содержит решения уравнения 
$x^2=2$.

Более строго, если есть два поля $K$, $L$, причем $L \subset K$
и $L$ замкнуто относительно операций (в $L$),
тогда большее поле $L$ называется \textbf{расширением поля} $K$.
Обозначается $L/K$, читается ''$L$ над $K$''.

Если $L$ -- расширение $F$, которое в свою очередь расширение $K$,
то $F$ называется \textbf{промежуточным полем}.

Для расширения $L/K$ и множества $S \subset L$ наименьшее подполе
$L$, обозначается $K(S)$ и говорят, что это поле образовано
\textbf{присоединением} элементов $S$.
Частный случай $K(s), s\in S$ называется \textbf{простым
расширением}, а $s$ -- его \textbf{примитивным элементом}.

Большее поле $L$ можно рассматривать как векторное пространство
над $K$ (т.е. может быть, что два или более элемента из $L$
могут быть линейно независимы при коэффициентах из $K$).
Размерность этого векторного поля называют \textbf{степенью 
расширения} и обозначают $[L:K]$.
Расширение степени 1 называют \textbf{тривиальным},
степени 2 -- \textbf{квадратичным}, 3 -- \textbf{кубическим}
и т.д.
Также в зависимости от конечности степени расширения могут
быть \textbf{конечными} или \textbf{бесконечными}.

Если $L$ -- расширение $K$, тогда элемент $L$ который является корнем
некоторого ненулевого полинома с коэффициентами из $K$ называют
\textbf{алгебраическим над $K$}.
Элементы, которые не являются алгебраическими, называют 
\textbf{трансцендентными}.

Для элемента $e \in L/K$ также определяют \textbf{минимальный полином}.
Если рассмотреть множество полиномов из $K[X]$, имеющих $e$ корнем,
можно доказать, что оно является идеалов.
Поскольку кольцо полиномов является областью главных идеалов,
этот идеал порождается одним полиномом $f$.
Он определен с точностью до умножения на константы (из $K$),
поэтому дополнительно накладывается условие, что $f$ -- приведенный
полином, т.е. старший коэффициент равен 1.
Такой полином и называется \textbf{минимальным полиномом}
для алгебраического элемента расширения поля.

Алгебраическое расширение $L/K$ называется \textbf{нормальным},
если каждый неприводимый полином, имеющий корень в $L$,
полностью разлагается на линейные множители над $L$.
Каждое алгебраическое расширение $F/K$ имеет \textbf{нормальное
замыкание} $L$, т.е. расширение $L/K$ такое, что $L/K$ -- нормально
и минимально с таким свойством.

Алгебраическое расширение $L/K$ называется \textbf{сепарабельным},
если минимальный полином каждого элемента из $L$ над $K$
является \textbf{сепарабельным}, т.е. не имеет кратных корней
в алгебраическом замыкании над $K$.

\textbf{Расширение Галуа} -- это алгебраическое расширение, которое 
является нормальным и сепарабельным.

\textbf{Автоморфизм} -- это изоморфизм (взаимно-однозначное
отображение), которое сохраняет дополнительные структуры объекта.
\ifexamples
Например, для поля оно сохраняет операции поля.
\fi

\textbf{Автоморфизм} расширения $E/F$ -- это автоморфизм $E$,
который сохраняет элементы $F$ (т.е. каждый из них отображается
в себя).
Автоморфизмы образуют группу $\mathrm{Aut}(E/F)$.

Если $E/F$ -- расширение Галуа, тогда его группа автоморфизмов
называется \textbf{группа Галуа} (расширения) $E$ над $F$
и обозначается $\Gal(E/F)$. 
Другими словами, группа Галуа переставляет добавленные корни 
некоторого полинома, оставляя на месте элементы основного поля.

Если $E/F$ -- \textbf{не} расширение Галуа, тогда часто
определяют $\Gal(E/F)$ как $\mathrm{Aut}(G/F)$, где $G$ --
замыкание Галуа для $F$ (т.е. минимальное из всех расширений
Галуа для $F$, содержащее $E$).

Первая задача -- выяснить структуру группы Галуа для различных
случаев расширений полей, в особенности поля $\Q$.

\ifexamples
\subsection{Примеры}
1. $\Gal(F/F)$ -- тривиальна, содержит один элемент \id -- автоморфизм,
который отображает каждый элемент в себя;

2. $\Gal(\C/\R)$ -- два элемента \id и $\sigma$ -- 
автоморфизм комплексного сопряжения;

3. $\Gal(\R/\Q)$ -- тривиальна;

4. $\Gal(\C/\Q)$ -- бесконечна;

5. $\Gal(\Q(\sqrt2)/\Q)$ -- два элемента \id и $\sigma$ -- 
автоморфизм сопряжения: $\sqrt2 \to - \sqrt2$;

6. Рассмотрим поле $K = \Q(\sqrt[3]{2})$;
группа $\mathrm{Aut}(K/\Q)$ содержит только \id;
это объясняется тем, что $K$ -- не нормальное расширение;

7. Рассмотрим поле $L = \Q(\sqrt[3]{2}, \omega)$, где 
$\omega$ -- примитивный корень 3-й степени из 1; 
тогда это расширение нормально и $\Gal(L/\Q)$ изоморфна
$S_3$ (группа перестановок трех элементов).
\fi

\section{Структура группы Галуа для циклических расширений}

\textbf{Циклическое расширение} (степени n) --
это присоединение корней полинома
$P(x) = 1+x+x^2+...+x^{n-1} = (x^n-1)/(x-1)$, т.е.
другими словами, присоединение всех корней степени $n$.

Группа корней степени $n$ из $1$ (с обычным умножением комплексных 
чисел) циклическая.
Элемент $e \in \C$ называется \textbf{примитивным корнем},
или \textbf{первообразным корнем} степени $n$ из $1$, если
$e$ порождает группу корней степени $n$.

Для циклического расширения $K$ группа
$\Gal(K/\Q)$ изоморфна $(\Z/n)^*$
(мультипликативной группе вычетов по модулю $n$).

При доказательстве используются несколько лемм.

Пусть $\mu_n$ -- группа корней из $1$ степени $n$, $K(\mu_n)$
-- расширение некоторого поля $K$ добавлением корней из $1$.

\textbf{Лемма 1.}
Для любого $\sigma \in \Gal(K(\mu_n)/K)$ существует целое число $a$,
взаимно простое с $n$, такое что
$\sigma(\zeta) = \zeta^a \;\; \forall \zeta \in \mu_n$.

\ifproofs
\proof
Пусть $\zeta_n$ -- примитивный корень, т.е.
генератор $\mu_n$, значит
$\zeta_n^n=1$ и $\zeta_n^j \neq 1 \; \; \forall j: 1\le j < n$.
Значит $\sigma(\zeta_n)^n = \sigma(\zeta_n^n) = \sigma(1) = 1$;
$\sigma(\zeta_n)^j = \sigma(\zeta_n^j) \neq 1$, иначе было бы
$\zeta_n^j = 1$. Таким образом, $\sigma(\zeta_n)$ тоже примитивный
корень.

Поскольку группа $\mu_n$ циклическая и $\zeta_n$ порождает ее,
значит каждый элемент группы есть некоторая степень $\zeta_n$
и в частности $\exists a: \sigma(\zeta_n) = \zeta_n^a$.
Это $a$ должно быть взаимно просто с $n$, иначе предположив, что
$d>1$ их общий делитель, получим: $n/d$ -- целое меньше $n$,
$a/d$ -- целое,
$\sigma(\zeta_n)^{(n/d)} = \zeta_n^{(an/d)} = (\zeta_n^n)^{(a/d)} = 1$,
что противоречит тому, что $\sigma(\zeta_n)$ тоже примитивный корень.

Итак, $a$ взаимно просто с $n$. 
Любое $\zeta \in \mu_n$ имеет вид $\zeta = \zeta_n^k$
для некоторого k, значит:
$\sigma(\zeta) = \sigma(\zeta_n^k) = \sigma(\zeta_n)^k = 
 \sigma(\zeta_n^a)^k =  \sigma(\zeta_n^k)^a = \zeta^a$.
$\square$
\fi

Отметим, что $a$ хорошо определено по модулю $n$: 
$\zeta_n^a = \zeta_n^b \Leftrightarrow a=b \mod n$,
поэтому элемент $a$ можно представлять как элемент
группы $(\Z/n)^*$.

\textbf{Лемма 2.}
Отображение $\Gal(K(\mu_n)/K) \to (\Z/n)^*$,
где $\sigma \to a_\sigma$ (как в лемме 1),
является инъективным групповым гомоморфизмом. 

\ifproofs
\proof
Возьмем любые $\sigma, \tau \in \Gal(K(\mu_n)/K)$.
Для примитивного корня $\zeta_n$: 
$(\sigma\tau)(\zeta_n) = \sigma(\tau(\zeta_n)) = 
\sigma(\zeta_n^{a_\tau}) = \sigma(\zeta_n)^{a_\tau} =
((\zeta_n)^{a_\sigma})^{a_\tau} = (\zeta_n)^{a_\sigma a_\tau}$.
Также $(\sigma\tau)(\zeta_n) = \zeta_n^{a_{\sigma\tau}}$,
т.е. $\zeta_n^{a_{\sigma\tau}} = (\zeta_n)^{a_\sigma a_\tau}$.
Так как $\zeta_n$ имеет порядок $n$, то
$a_{\sigma\tau} = a_\sigma a_\tau \mod n$.
Мы показали, что $\sigma \to a_\sigma \mod n$ является групповым
гомоморфизмом.

Если взять $\sigma$ из ядра гомоморфизма, т.е. $a_\sigma = 1 \mod n$,
значит $\sigma(\zeta_n) = 1$, следовательно
$\sigma(\zeta) = \zeta \;\; \forall \zeta \in \mu_n$.
Также по определению $\sigma$ отображает в себя все элементы из $K$.
Итак, мы получили, что $\sigma$ отображает в себя все элементы
из $K(\mu_n)$. Таким образом $\sigma = \id$ в $\Gal(K(\mu_n)/K)$.

Мы показали, что ядро гомоморфизма содержит только $\id$,
это и доказывает, что гомоморфизма инъективен, поскольку
предположив обратное, мы нашли бы элемент из ядра не равный $\id$.

$\square$
\fi

Таким образом, группа Галуа циклического расширения всегда
является подгруппой группы $(\Z/n)^*$.
Поскольку $(\Z/n)^*$ абелева группа, то следовательно
и группа Галуа абелева.
Циклические расширения \textit{всегда абелевы}.

Отображение $\Gal(K(\mu_n)/K) \to (\Z/n)^*$
(его еще называют \textbf{погружением}) может
\textit{не быть сюрьективным}, это зависит от поля $K$.

\ifexamples
Например, если $K=\R$ и $n\ge3$, то
$K(\mu_n)/K=\C/\R$ -- квадратичное расширение,
и единственный нетривиальный $\R$-автоморфизм -- это
комплексное сопряжение.
На корнях из единицы он определяется через обратный:
$\overline\zeta = \zeta^{-1}$, т.е. образ группы Галуа в этом
случае: ${\pm 1 \mod n}$, что меньше, чем $(\Z/n)^*$,
кроме случаев $n=2, 3, 4, 6$.
\fi

Тем не менее, можно показать сюрьективность в случае $K=\Q$
и описать образ в случае $K=\Fp$ без сюрьективности.

Дополнительно в теореме используется лемма Гаусса.
Будем называть НОД (content), $\cont(f)$ для полинома $f$
наибольший общий делитель коэффициентов.
Если коэффициенты целые, $\cont(f)$ определяется очевидным образом.
Если коэффициенты рациональные ($f \in \Q[X]$), тогда
$\exists n: nf \in \Z[X], \cont(f) := \cont(nf)/n$.

\textbf{Примитивный} полином -- это полином $f$ из $\Q[X]$, 
для которого $\cont(f)=1$.

\textbf{Лемма 3.}
Полином с рациональными коэффициентами имеет целые коэффициенты
тогда и только тогда, когда $\cont(f)$ целое.

\ifproofs
\proof

a) $f \in \Z[X] \Rightarrow \cont(f) \in \Z$
по определению.

b) Пусть $m = \min \{ n \in \N : nf \in \Z[X] \}$.
   Тогда по определению:
   $\cont(f) = \gcd \{ ma_0, ..., ma_q \} / m$, $q$ -- степень f.

b1) $\gcd$ кратно $m$: тогда все $ma_0, ..., ma_q$ кратны $m$, тогда
    все $a_0, ..., a_q$ -- целые.

b2) $\gcd$ не кратно $m$: тогда $\cont(f)$ нецелое, что противоречит
  условию.
   
$\square$
\fi

\textbf{Лемма Гаусса.}
Произведение примитивных полиномов примитивно.

\ifproofs
\proof
Из определения примитивных полиномов видно, что их коэффициенты
целые.
Коэффициенты произведения: $c_k = \sum_{p+q=k} a_p b_q$ -- очевидно
также целые.

Предположим, $fg$ не примитивный, тогда коэффициенты имеют
$\gcd > 1$, значит найдется простое $p$, делящее все коэффициенты.
Поскольку $p$ не может делить все коэффициенты $f$, $g$ (по отдельности),
так как  они примитивны, можно найти индексы:

$i$ -- минимальное целое, такое что $p$ не делит $a_i$;

$j$ -- минимальное целое, такое что $p$ не делит $b_j$;

Рассмотрим коэффициент произведения:
$c_{i+j} = \sum_{p+q=i+j} a_p b_q = 
  ( a_0 b_{i+j} + a_1 b_{i+j-1} + ... + a_{i-1} b_{j+1} )
  + a_{i} b_{j} + 
  ( a_{i+1} b_{j-1} + ... + a_{i+j} b_0 )$
  
Можно заметить, что в первой скобке $p$ делит все $a_0, ..., a_{i-1}$,
значит первая скобка делится на $p$.
Аналогично во второй скобке $p$ делит все $b_0, ..., b_{j-1}$,
значит и вторая скобка делится на $p$.
Тем не менее оставшееся слагаемое $a_{i} b_{j}$ не делится на $p$
по определению коэффициентов $i, j$.
  
Таким образом $c_{i+j}$ не делится на $p$ вопреки нашему
предположению.

$\square$
\fi

\textbf{Следствие}
Для $f, g \in \Q[X]$ $\cont(fg) = \cont(f)\cont(g)$.

\ifproofs
\proof

Можно представить:
$f = \cont(f) f^*, g = \cont(g) g^*$, где $f^*, g^*$ --
примитивные полиномы.
Тогда
$$fg = \cont(f) \cont(g) f^* g^*$$
$$\cont(fg) = \cont(f) \cont(g) \cont(f^* g^*)$$

По лемме Гаусса произведение примитивных полиномов примитивно. 
$$\cont(fg) = \cont(f) \cont(g)$$

$\square$
\fi

\textbf{Теорема.}
Отображение $\Gal(\Q(\mu_n)/\Q) \to (\Z/n)^*$ -- изоморфизм.

\ifproofs
\proof
Когда мы докажем сюрьективность, этого будет достаточно, поскольку
инъективность доказана выше, а инъективный и сюрьективный гомоморфизм
и есть изоморфизм.

Сюрьективность означает, что для каждого $a\in \Z, (a, n)=1$
найдется элемент $\sigma$ группы Галуа, переводящий $\zeta_n$ в
$\zeta_n^a$. Это эквивалентно тому, что их минимальные полиномы
одинаковы.

Пусть $f(\zeta_n)=0$ -- минимальный полином для $\zeta_n$.

a) $\sigma(\zeta_n) = \zeta_n^a$

$f(\zeta_n^a) = f( \sigma(\zeta_n) ) = \sigma( f( \zeta_n ) ) = 
\sigma(0) = 0$
потому что $0$ -- элемент базового поля ($\Q$) и следовательно
все элементы группы Галуа оставляют его на месте.
Итак, $f$ -- минимальный полином также для $\zeta_n^a$.

b) $f(\zeta_n^a)=0$.

Поскольку $(a, n)=1$, можно найти ''обратный'': $b$ такой что
$ab=1 \mod n$.
Возьмем элемент $\sigma_b$ для $b$. Тогда элементы $\zeta_n^a$ и
$\sigma_b(\zeta_n^a)$ имеют одинаковые минимальные полиномы, см. a).
Но $\sigma_b(\zeta_n^a) = \zeta_n^{ab} = \zeta_n$, следовательно
$\zeta_n$ и $\zeta_n^a$ имеют одинаковые минимальные полиномы.

Таким образом, нам нужно показать, что для любого $a\in \Z,
(a,n)=1$ минимальные полиномы $\zeta_n$ и $\zeta_n^a$ одинаковы.

Поскольку степень примитивного корня зависит только от $a \mod n$
и поскольку $a=0$ не удовлетворяет $(a,n)=1$ можно считать что $a>0$.
Более того, для $a=1$ утверждение тривиально.

Рассмотрим $a>1$. Разложим на простые множители:
$a = p_1 p_2 ... p_r$ (некоторые $p_i$ могут быть одинаковы,
все $p_i$ не делят $n$).

Достаточно показать, что $\zeta_n$ и его \textbf{простая}
степень $\zeta_n^p$ имеют одинаковый минимальный полином,
поскольку далее можно рассматривать соседние пары:
$\zeta_n, \zeta_n^{p_1}, \zeta_n^{p_2}, ... \zeta_n^{p1 ... p_r} = \zeta_n^a$,
они будут иметь одинаковые минимальные полиномы и утверждение 
будет доказано.

Утверждение для простой степени докажем от противного.
Пусть $f(T)$ -- минимальный полином для $\zeta_n$ над $\Q$,
$g(T)$ (не равный $f$) -- для $\zeta_n^p$.
Полиномы $f$, $g$ неприводимы над $\Q$ и взаимно
простые (иначе их степень можно было бы уменьшить),
Оба полинома приведенные и делят $T^n - 1$.

Из этого можно сделать вывод, что $f, g \in Z[T]$.
Так как $\cont(T^n - 1)=1$, все делители этого многочлена имеют
$\cont(h) = 1$, следовательно они имеют целые коэффициенты
(см. выше лемма Гаусса и сопутствующие леммы).
Это верно и для $f, g$ поскольку они делят $T^n - 1$.

Поскольку $g(\zeta_n^p) = 0$, полином $g(T^p)$ имеет корень
$\zeta_n$, значит $f(T) | g(T^p)$: $g(T^p) = f(T) k(T)$.

Применим к этому уравнению редукцию $\mod p$:
$\overline g(T^p) = \overline f(T) \overline k(T)$

В поле $\Fp$ есть очень полезный и часто применяемый
гомоморфизм Фробениуса: $x \to x^p$. Можно проверить, что 
$1^p = 1$, $(ab)^p = a^p b^p$. 
В биноме
$(a+b)^p = \sum_{k=0}^p C_p^k a^k b^{p-k}$
можно доказать, что все коэффициенты, кроме первого ($k=0$)
и последнего ($k=p$) делятся на $p$.

$$C_p^k = \frac{p(p-1)(p-2)...(p-k+1)}{1\cdot 2 \cdot 3... k}$$

Биномиальный коэффициент -- целое число, и $0<k<p$ (мы смотрим не
крайние коэффициенты), так что множитель $p$ не сокращается
числами $1, 2, ..., k$,
значит биномиальный коэффициент делится на $p$, отсюда:
$(a+b)^p = a^p + b^p \mod p$

Таким образом, можно записать: $g(T^p) = g(T)^p \mod p$, а значит

$\overline g(T)^p = \overline f(T) \overline k(T)$

Таким образом, любой неприводимый фактор $\overline f$ делит
$\overline g$, т.е. эти полиномы \textbf{не} взаимно простые.

В то же время, $T^n-1$ сепарабелен над $\Fp$
(нет кратных корней, что можно проверить через НОД с производной,
важно, что $p$ не делит $n$), так что его факторы не могут иметь
общих корней, т.е. все факторы взаимно простые
(или должны совпадать).

Это противоречие доказывает теорему.

$\square$

\fi

\textbf{Теорема.}
Если простое $p$ не делит $n$, образ группы Галуа
$\Gal(\Fp(\mu_n)/\Fp)$ в $(\Z/n)^*$ под действием
стандартного погружения есть $p \mod n$.


\end{document}
